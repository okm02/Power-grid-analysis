\section{Introduction}
\label{introduction}

In scale-free networks (SF) the probability of a node being connected to $k$ others exhibits a power-law distribution $P(k) \propto k^{-\alpha}$, which is a topological property affecting and controlling their resilience or the measure of their functionality subject to disruptions \cite{Newman:2003da,Gao:2015fg,Bashan:2013cja,2000Natur.406..378A}. Examples of this class of SF are the Internet, power systems, and transportations networks, which are real-world networks shown to be robust when subject to random failures, yet, displaying a high vulnerability when subjected to cascading ones \cite{Bompard:2011cd,DuenasOsorio:2009ff,2016arXiv160904310M,Cohen:2001hf}. 

In power systems, and unlike random failures which emerge locally, blackouts are severe events  associated with cascading behavior leading to global network collapse \cite{RosasCasals:2007td,Bompard:2009ga,Brummitt:2013jj,Daqing:2014bp,Albert:2004bw,Wang:2011js,Sole:2008cv}. Examples such as the one affecting the north-east in the US and eastern Canada in 2003 burdened the respective economies with ten billion dollars of direct costs \cite{Daqing:2014bp}. Such failures can be linked to either structural dependencies, where the damage spreads via structurally dependent connections, or functional overloads, where the flow goes through alternative paths leading to overloaded nodes. Thus, understanding the propagation of these failures becomes pivotal in developing and deploying protective and mitigating strategies. 

Large power systems and real-world networks in general exhibit an exponentially increasing combinatorial number of failure nodes. Older works tackling contingency analysis relied on approximate power flow solutions, exhibiting only a simplified analysis of all combinatorial contingencies \cite{EjebeAl79,Ekwue91}. These approaches also levy an overwhelming computational burden that cannot be accomplished in real-time. Also, traditional approaches that employ the $N$-1 criterion are only able to investigate the ability of the transmission system to lose a power line or a power generator without causing an overload failure elsewhere. Examples of such approaches are employed by the North American Electric Reliability Corporation (NERC) \cite{JinAl10}, and obviously do not capture the overload failures that propagate through interactions among a system's physical components. It thus becomes necessary to be able to perform $N$-$x$ ($x \geq2$) contingency analysis to assess whether a system can withstand the failure of any two or more components. In several leading works such as \cite{2000Natur.406..378A,JinAl10, DaqingAl14}, the power grid, particularly the network of its transmission lines, is analyzed using graph algorithms such as betweenness centrality and shortest paths. In this paper, we build on the approach in  \cite{2000Natur.406..378A} using an Apache Spark implementation of topological vulnerability analysis of the Lebanese power grid subject to random  and cascading failures. Beyond the scholarly aspects of our proposed work, our analysis contributes towards precision-based policy making and disaster response in a region marred by wars and under-development. 
 
\secondedited{
Using elements from distributed algorithm design as well as spatial analysis, our work extends the approach of \cite{2000Natur.406..378A} in analysing the vulnerability of transmission lines to the assessment of that of the whole Lebanese power grid, including its generation, distribution, and transmission lines. However, in contrast to this cited body of work, our approach yields a system that is fault-tolerant to hardware failures and ensures locality of reference to avoid data movement (e.g., network communications in case of distributed setting, and garbage collector and memory allocation in case of local setting). Despite that our input graph is not dramatically a ``big graph'', our use of Spark is meant to provide for the following: (1) scalability, represented by a solution that is shown to remain promising and effective when the input graph scales to such daunting sizes, when tackling either networks of networks or power plants in larger countries; (2) fault tolerance: if and when the input graph size increases, failures -- aka faults -- resulting from out-of-memory accesses and computations, message loss, network error, to name a few causes, would begin to appear very frequently as opposed to rarely, which, in the absence of a fault-tolerant platform, would require one to re-perform the whole computations. Spark provides for fault-tolerance using lineage techniques as well as efficient distributed in-memory computation. The choice of Spark also renders our system to be suitable for clusters of commodity computers with relatively slow and cheap interconnects, and susceptible to many machine failures.}
%
Our implementation is based on the BSP~\cite{bsp} model and employs serial graph algorithms on distributed data in SPMD mode (single program, multiple data). Our data parallel algorithm maintains parallel optimal-work, linear communication time, and a constant number of synchronisation barriers.‚Äù
%
%Our implementation is based on the bulk-synchronous parallel (BSP)~\cite{bsp} model and maintains optimal work, linear communication time, and a constant number of synchronisation barriers. 
%By targeted attacks, we do not merely allude to acts of aggression on power generating centers, but also to increasing consumption associated with a diminished national carrying capacity following the refugees influx.

Our manuscript is organized as follows. In Sec. \ref{background}, we present an overview of related work that tackles power grid resilience analysis as well as implementations of it that runs on distributed systems, and we describe some intrinsics related to Apache spark for big data distributed processing. In Sec. \ref{methods}, we present our distributed graph algorithm that builds on the loosely centralized structure of the Lebanese power grid using Breadth First Search and Vertex Betweenness Centrality, orchestrated using four scenarios known in the literature \cite{2000Natur.406..378A}. Each of these scenarios simulates a unique temporal mode of removal of vertices. 
%
\edited{Despite that our approach does not generalise to arbitrary networks, we believe there is merit in tackling the specifics related to the Lebanese power grid, especially after Lebanon has withstood decades of wars and a lack of infrastructure rebuilding. Still, our approach can generalize to networks of low connectivity such as that found in the Lebanese grid.}
%
In Sec. \ref{results}, we perform run-time analysis of our algorithm and obtain excellent scalability for some scenarios as the number of processing cores increases up to 16, a result which we attribute to the large number of connected components found in the Lebanese power grid and the fact that majority of connected components have a relatively small cardinality. In fact, scalability towards $32$ nodes improves when experimenting with replicas of the power grid graph that are double and quadruple the original size. We demonstrate the loss in connectivity in the power grid associated with each scenario, and obtain that the Lebanese power grid exhibits a relatively strong resilience thanks to its decentralised structure. We also perform a spatial correlation analysis of failures using the geocoding of vertices that lead to $90\%$ loss in connectivity. Our results reveal that failures in the power grid are spatially long-range correlated, and that correlations decay with distance. In Sec. \ref{conclusion}, we conclude with remarks around the impact of our work.%, particularly, as it relates to directing policy making. should current trends of refugee influx continue. It is our hope that our work can help answer questions such as: what factors will affect future observations at different locations on Lebanese soil? and what can be done to better manage our dwindling vital systems?  





